<!-- //!---------- Drag & Drop  -------------- -->

<!-- <div class="dropzone">
    <input 
        type="file"
        class="px-5 py-3"
        accept="allowedTypes"
        multiple="allowMultipleFiles"
        (drop)="onFiledrop($event)"
        (change)="onFileSelected($event)"
        #fileDropRef />
<label 
        *ngIf="!label; else customLabel"
        for="fileDropRef">
        <b class="bold-blue">Click to upload</b>
        or drag and drop
    </label>
<ng-template #customLabel for="fileDropRef">{{ label }}</ng-template>
    
    <div class="allowed-types">
        Allowed file types: {{ allowedList }}
    </div>
    
    <div class="uploadedFiles" *ngIf="!!files">
        <div *ngFor="let file of files">Uploaded: {{ file.name }}</div>
    </div>

    <div *ngIf="incorrectInput" class="error-alert">{{ errorMessage }}</div>
</div> -->
<!-- ! ------------ End OF Drag & Drop ----------  -->

<!-- ! ------------ Start OF Company View Type Script ----------  -->
<!--
// import { SidebarService } from './../../Core/Services/sidebar.service';
// import { CompanyService } from './../../Core/Services/company.service';
// import { CommonModule } from '@angular/common';
// import {
//   ChangeDetectorRef,
//   Component,
//   ElementRef,
//   EventEmitter,
//   Input,
//   OnInit,
//   Output,
// } from '@angular/core';
// import { MatChipsModule } from '@angular/material/chips';
// import { Company, Owner } from '../../Core/interfaces/company/company';
// import { ActivatedRoute, Router } from '@angular/router';
// import { AddCompanyModalComponent } from '../company-modal/company-modal.component';
// import { MatDialog } from '@angular/material/dialog';
// import { DeleteModalComponent } from '../deletemodal/deletemodal.component';
// import { ProfileService } from '../../Core/Services/profile.service';
// import { ProjectCategory } from '../../Core/interfaces/company/project-category';
// import { ProjectService } from '../../Core/Services/project.service';
// import { Project, ProjectResult } from '../../Core/interfaces/project';

// @Component({
//   selector: 'app-company-view',
//   standalone: true,
//   imports: [CommonModule, MatChipsModule],
//   templateUrl: './company-view.component.html',
//   styleUrl: './company-view.component.css',
// })
// export class CompanyViewComponent implements OnInit {
//   @Input() company!: Company;
//   @Output() companySelected = new EventEmitter<any>();
//   @Output() companyDeleted = new EventEmitter<void>();
//   isOwner = false;
//   userId!: any;
//   // variables
//   constructor(
//     private cdr: ChangeDetectorRef,
//     private sidebarService: SidebarService,
//     private companyService: CompanyService,
//     private projectService: ProjectService,
//     private route: ActivatedRoute,
//     private dialog: MatDialog,
//     private router: Router,
//     private _profile: ProfileService
//   ) {}
//   isSidebarCollapsed = true;
//   Owner: Owner | null = null;
//   CompanyId: number = 0;

//   // ----------------------------------------
//   ngOnInit(): void {
//     this.sidebarService.isCollapsed$.subscribe((collapsed) => {
//       this.isSidebarCollapsed = collapsed;
//     });
//     this.route.paramMap.subscribe(() => {
//       this.getCompany();
//     });
//     // this.getProjectData(String(this.CompanyId));
//     // this.getProjectData();
//   }

//   selectCompany() {
//     this.companySelected.emit(this.company.id);
//     this.CompanyId = parseInt(this.CompanyId as unknown as string);
//   }

//   contactInfo: any = [
//     {
//       icon: 'assets/images/Email.svg',
//       label: 'Email',
//       value: this.Owner?.email,
//     },
//     {
//       icon: 'assets/images/LinkedIn.svg',
//       label: 'LinkedIn',
//       value: 'linkedin.com/in/johndoe',
//     },
//     {
//       icon: 'assets/images/WhatsApp.svg',
//       label: 'WhatsApp',
//       value: this.Owner?.phoneNumber,
//     },
//   ];

//   projectStats = [
//     { title: 'Total Projects', count: 10, class: 'total-projects' },
//     { title: 'Completed Projects', count: 5, class: 'completed-projects' },
//     { title: 'Projects In Progress', count: 3, class: 'projects-inprogress' },
//     { title: 'Projects Overdue', count: 4, class: 'overdue-projects' },
//   ];

//   cardClasses = [
//     'cardBottomRight',
//     'cardBottomLeft',
//     'cardTopRight',
//     'cardTopLeft',
//   ];

//   ProjectCategories: ProjectCategory[] = [
//     {
//       name: 'In Progress',
//       icon: 'assets/images/Issue Status/in-progress.svg',
//       class: 'inprogress-tag',
//       status: 'inprogress',
//       issues: [
//         {
//           title: 'Project 3',
//           startDate: '5-3',
//           dueDate: '5-16',
//           description:
//             'Lorem ipsum dolor sit amet consectetur adipisicing elit.',
//           category: 'backend',
//         },
//         {
//           title: 'Project 4',
//           startDate: '5-3',
//           dueDate: '5-16',
//           description:
//             'Lorem ipsum dolor sit amet consectetur adipisicing elit.',
//           category: 'frontend',
//         },
//       ],
//     },
//     {
//       name: 'Completed',
//       icon: 'assets/images/Issue Status/Completed.svg',
//       class: 'completed-tag',
//       status: 'completed',
//       issues: [
//         {
//           title: 'Project 5',
//           startDate: '5-5',
//           dueDate: '5-18',
//           description:
//             'Lorem ipsum dolor sit amet consectetur adipisicing elit.',
//           category: 'frontend',
//         },
//       ],
//     },
//     {
//       name: 'Overdue',
//       icon: 'assets/images/Issue Status/Important Time.svg',
//       class: 'overdue-tag',
//       status: 'overdue',
//       issues: [
//         {
//           title: 'Project 1',
//           startDate: '5-1',
//           dueDate: '5-12',
//           description:
//             'Lorem ipsum dolor sit amet consectetur adipisicing elit.',
//           category: 'web',
//         },
//         {
//           title: 'Project 2',
//           startDate: '5-2',
//           dueDate: '5-15',
//           description:
//             'Lorem ipsum dolor sit amet consectetur adipisicing elit.',
//           category: 'mobile',
//         },
//       ],
//     },
//   ];

//   projectStatus = [
//     'inprogress-wrapper',
//     'completed-wrapper',
//     'overdue-wrapper',
//   ];

//   spanStatus = ['inprogress-span', 'completed-span', 'overdue-span'];

//   // get tenant data
//   getCompany(): void {
//     this._profile.getProfileData().subscribe({
//       next: (user) => {
//         this.userId = user.id;
//         const companyId = this.route.snapshot.paramMap.get('id');
//         if (companyId) {
//           this.companyService.getCompanyData(companyId).subscribe({
//             next: (res) => {
//               console.log(res);
//               this.company = res.result;
//               this.Owner = res.result.owner;
//               console.log(this.Owner);
//               this.CompanyId = res.result.id; // ✅ Set CompanyId here
//               this.getProjectData(); // ✅ Fetch project data after setting ID
//               // ✅ Update contactInfo after Owner is assigned
//               this.contactInfo = [
//                 {
//                   icon: 'assets/images/Email.svg',
//                   label: 'Email',
//                   value: this.Owner?.email || 'N/A', // ✅ Ensure it does not remain undefined
//                 },
//                 {
//                   icon: 'assets/images/LinkedIn.svg',
//                   label: 'LinkedIn',
//                   value: 'linkedin.com/in/johndoe',
//                 },
//                 {
//                   icon: 'assets/images/WhatsApp.svg',
//                   label: 'WhatsApp',
//                   value: this.Owner?.phoneNumber || 'N/A', // ✅ Handle missing values
//                 },
//               ];

//               // ✅ Trigger change detection (if needed)
//               this.cdr.detectChanges();

//               if (this.company.owner.id !== this.userId) {
//                 this.isOwner = false; // hide delete button
//               } else {
//                 this.isOwner = true; // show delete button
//               }
//             },
//             error: (err) =>
//               console.error('Error fetching company details:', err),
//           });
//         }
//       },
//     });
//   }

//   // copy function
//   copied = { code: false, url: false };
//   copyText(text: 'code' | 'url') {
//     navigator.clipboard
//       .writeText(
//         text === 'code' ? this.company.tenantCode : this.company.tenantUrl
//       )
//       .then(() => {
//         this.copied[text] = true;
//         this.cdr.markForCheck();
//         setTimeout(() => {
//           this.copied[text] = false;
//           this.cdr.markForCheck();
//         }, 2000);
//       });
//   }

//   getWrapperClass(status: string): string {
//     switch (status) {
//       case 'inprogress':
//         return this.projectStatus[0];
//       case 'completed':
//         return this.projectStatus[1];
//       case 'overdue':
//         return this.projectStatus[2];
//       default:
//         return '';
//     }
//   }

//   getSpanStatus(status: string): string {
//     switch (status) {
//       case 'inprogress':
//         return this.spanStatus[0];
//       case 'completed':
//         return this.spanStatus[1];
//       case 'overdue':
//         return this.spanStatus[2];
//       default:
//         return '';
//     }
//   }

//   isValidUrl(url: any): boolean {
//     return !!(url && url !== 'string' && url.trim() !== '');
//   }

//   delete() {
//     const dialogRef = this.dialog.open(DeleteModalComponent, {
//       width: 'auto',
//       minWidth: '40vw',
//       maxWidth: '50vw',
//       minHeight: '40vh',
//       maxHeight: '50vh',
//       disableClose: true,
//       data: { companyId: this.company.id }, // ✅ Pass company id to modal
//     });
//     dialogRef.afterClosed().subscribe((result) => {
//       if (result === 'deleted') {
//         console.log('Company deleted successfully');
//         this.sidebarService.notifyCompanyDeleted();
//         this.router.navigate(['/MyDashboard/allcompanies']);
//       }
//     });
//   }

//   // ----------- Get Project Info -----------//
//   // getProjectData() {
//   //   this.projectService.getProjectData(this.CompanyId).subscribe({
//   //     next: (res) => {
//   //       console.log('Projjjjjjjjjjject');
//   //       console.log(res);
//   //       // this.project = res.result;
//   //       // console.log(this.project);
//   //     },
//   //   });
//   // }
//   // getProjectData() {
//   //   this.projectService.getProjectData(this.CompanyId).subscribe({
//   //     next: (res) => {
//   //       console.log('Project Data Received:', res);

//   //       // Initialize counters
//   //       let totalProjects = 0;
//   //       let completedProjects = 0;
//   //       let inProgressProjects = 0;
//   //       let overdueProjects = 0;

//   //       // Ensure response contains data
//   //       if (res.isSuccess && res.result) {
//   //         totalProjects = res.result.length; // Total projects

//   //         res.result.forEach((project: any) => {
//   //           switch (project.status.toLowerCase()) {
//   //             case 'completed':
//   //               completedProjects++;
//   //               break;
//   //             case 'inprogress':
//   //               inProgressProjects++;
//   //               break;
//   //             case 'overdue':
//   //               overdueProjects++;
//   //               break;
//   //           }
//   //         });
//   //       }

//   //       // Update project statistics dynamically
//   //       this.projectStats = [
//   //         {
//   //           title: 'Total Projects',
//   //           count: totalProjects,
//   //           class: 'total-projects',
//   //         },
//   //         {
//   //           title: 'Completed Projects',
//   //           count: completedProjects,
//   //           class: 'completed-projects',
//   //         },
//   //         {
//   //           title: 'Projects In Progress',
//   //           count: inProgressProjects,
//   //           class: 'projects-inprogress',
//   //         },
//   //         {
//   //           title: 'Projects Overdue',
//   //           count: overdueProjects,
//   //           class: 'overdue-projects',
//   //         },
//   //       ];

//   //       console.log('Updated Project Stats:', this.projectStats);
//   //     },
//   //     error: (err) => console.error('Error fetching project data:', err),
//   //   });
//   // }

//   Project: ProjectResult[] | null = null;

// getProjectData() {
//   this.projectService.getProjectData(this.CompanyId).subscribe({
//     next: (res: Project) => {

//       // -------- Projects Counters --------- //
//       console.log('Project Data Received:', res);

//       // Initialize counters
//       let totalProjectsCounter = 0;
//       let completedProjectsCounter = 0;
//       let inProgressProjectsCounter = 0;
//       let overdueProjectsCounter = 0;

//       // Ensure response contains data
//       if (res.isSuccess && res.result) {
//         totalProjectsCounter = res.result.length; // Total projects

//         res.result.forEach((project: any) => {
//           switch (project.status.toLowerCase()) {
//             case 'completed':
//               completedProjectsCounter++;
//               break;
//             case 'Working on':
//               inProgressProjectsCounter++;
//               break;
//             case 'overdue':
//               overdueProjectsCounter++;
//               break;
//           }
//         });
//       }

//       // Update project statistics dynamically
//       this.projectStats = [
//         {
//           title: 'Total Projects',
//           count: totalProjectsCounter,
//           class: 'total-projects',
//         },
//         {
//           title: 'Completed Projects',
//           count: completedProjectsCounter,
//           class: 'completed-projects',
//         },
//         {
//           title: 'Projects In Progress',
//           count: inProgressProjectsCounter,
//           class: 'projects-inprogress',
//         },
//         {
//           title: 'Projects Overdue',
//           count: overdueProjectsCounter,
//           class: 'overdue-projects',
//         },
//       ];

//       console.log('Updated Project Stats:', this.projectStats);

//       console.log('Project Data Received:', res);

//       if (!res.isSuccess || !res.result) {
//         console.error("Failed to fetch projects");
//         return;
//       }

//       // Extract project results
//       const projects: ProjectResult[] = res.result;

//       // Categorize projects
//       const inProgressProjects = projects.filter(p => p.status === "InProgress");
//       const completedProjects = projects.filter(p => p.status === "Completed");
//       const overdueProjects = projects.filter(p => p.status === "Overdue");

//       // Update project categories dynamically
//       this.ProjectCategories = [
//         {
//           name: 'In Progress',
//           icon: 'assets/images/Issue Status/in-progress.svg',
//           class: 'inprogress-tag',
//           status: 'inprogress',
//           issues: inProgressProjects.map(project => ({
//             title: project.name,
//             startDate: project.startDate,
//             dueDate: project.endDate,
//             description: project.description,
//             category: project.priority,
//           }))
//         },
//         {
//           name: 'Completed',
//           icon: 'assets/images/Issue Status/Completed.svg',
//           class: 'completed-tag',
//           status: 'completed',
//           issues: completedProjects.map(project => ({
//             title: project.name,
//             startDate: project.startDate,
//             dueDate: project.endDate,
//             description: project.description,
//             category: project.priority,
//           }))
//         },
//         {
//           name: 'Overdue',
//           icon: 'assets/images/Issue Status/Important Time.svg',
//           class: 'overdue-tag',
//           status: 'overdue', // Fixed error: 'Overdue' is now correctly assigned to 'status'
//           issues: overdueProjects.map(project => ({
//             title: project.name,
//             startDate: project.startDate,
//             dueDate: project.endDate,
//             description: project.description,
//             category: project.priority,
//           }))
//         }

//       ];

//       console.log('Updated Project Categories:', this.ProjectCategories);
//     },
//     error: (err) => console.error('Error fetching project data:', err),
//   });
// }

// }
-->

<!-- ! ------------ End OF Company View Type Script ----------  -->

<!-- Side menu -->
<!-- toggleCollapse(): void { if (this.isTransitioning) return;
this.isTransitioning = true; this.collapsed = !this.collapsed;
this.sidebarService.setSidebarState(this.collapsed);
this.cdRef.markForCheck(); setTimeout(() => { this.isTransitioning =
false; }, 300); } -->

<!-- // {
    //   id: 1,
    //   name: 'Company B',
    //   projects: [
    //     {
    //       id: 0,
    //       name: 'Project 1',
    //     },
    //   ],
    // }, -->

<!-- // ! getCompanies(): void {
  //   this._companyService.getAllCompanies(null).subscribe({
  //     next: (res) => {
  //       console.log(res);
  //       if (res?.result && res.result.length > 0) {
  //         this.companyNames = res.result.map(
  //           (company: { id: string; name: string }) => ({
  //             id: company.id,
  //             name: company.name,
  //           })
  //         );
  //         this.companyData = res.result;

  //         // this.companies = [
  //         //   {
  //         //     // id: this.companyData.id,
  //         //     id: 0,
  //         //     name: 'Company A',
  //         //     projects: [
  //         //       {
  //         //         name: 'Project 1',
  //         //         sprints: [{ name: 'Sprint 1' }, { name: 'Sprint 2' }],
  //         //       },
  //         //     ],
  //         //   },
  //         // ]

  //         const companyIndex = this.companies.findIndex(
  //           (c) => c.id === this.SelectedCompanyId
  //         );

  //         // Call getProjectData only if SelectedCompanyId is defined
  //         if (this.SelectedCompanyId) {
  //           this.getProjectData();
  //         }
  //       }
  //     },
  //     error: (err) => console.error(err),
  //   });
  // }

  // getCompanies(): void {
  //   this._companyService.getAllCompanies(null).subscribe({
  //     next: (res) => {
  //       console.log('Companies API response:', res);
  //       if (res?.result && res.result.length > 0) {
  //         this.companyNames = res.result.map((company: any) => ({
  //           id: company.id,
  //           name: company.name,
  //         }));
  //         this.companyData = res.result;

  //         // Store companies and initialize projects as empty
  //         this.companies = this.companyData.map((company) => ({
  //           id: company.id,
  //           name: company.name,
  //           projects: [],
  //         }));

  //         // Automatically select the first company (Optional)
  //         this.SelectedCompanyId = this.companyData[0]?.id || 0;
  //         console.log('Selected Company ID:', this.SelectedCompanyId);

  //         if (this.SelectedCompanyId) {
  //           this.getProjectData(); // Fetch projects after setting company
  //         }
  //       }
  //     },
  //     error: (err) => console.error('Error fetching companies:', err),
  //   });
  // } -->

<!-- // Store companies and initialize projects as empty
              // this.companies = this.companyData.map((company) => ({
              //   id: company.id,
              //   name: company.name,
              //   projects: [],
              // }));
              // console.log('Companies after processing:', this.companies);
              // // Fetch projects for each company
              // this.fetchProjectsForAllCompanies(); -->

<!-- // fetchProjectsForAllCompanies() {
  //   this.companies.forEach((company, index) => {
  //     this._ProjectService.getProjectData(company.id).subscribe({
  //       next: (res) => {
  //         console.log(`Project API response for company ${company.id}:`, res);
  //         if (res && res.result && res.result.length > 0) {
  //           this.companies[index].projects = res.result.map((project: any) => ({
  //             id: project.id,
  //             name: project.name,
  //           }));
  //         } else {
  //           console.warn(`No projects found for company ID: ${company.id}`);
  //         }
  //       },
  //       error: (err) =>
  //         console.error(
  //           `Error fetching project data for company ${company.id}:`,
  //           err
  //         ),
  //     });
  //   });
  // } -->

<!-- 
                // console.log(
              //   `Project API response for company ${companyId}:`,
              //   response
              // ); -->

<!-- // getProjectData() {
  //   if (!this.SelectedCompanyId) {
  //     console.error(
  //       'SelectedCompanyId is undefined, skipping project data fetch.'
  //     );
  //     return;
  //   }

  //   this._ProjectService.getProjectData(this.SelectedCompanyId).subscribe({
  //     next: (res) => {
  //       if (res.isSuccess && res.result.length > 0) {
  //         console.log('Project data received:', res.result);
  //         this.projects = res.result;

  //         // Find the selected company in the array
  //         const companyIndex = this.companies.findIndex(
  //           (c) => c.id === this.SelectedCompanyId
  //         );

  //         if (companyIndex !== -1) {
  //           // Assign projects with static sprints
  //           this.companies[companyIndex].projects = this.projects.map(
  //             (project) => ({
  //               name: project.name,
  //               sprints: [{ name: 'Sprint 1' }, { name: 'Sprint 2' }],
  //             })
  //           );
  //         } else {
  //           console.warn('Company not found in companies array.');
  //         }
  //       } else {
  //         console.warn(
  //           'No projects found or API response error:',
  //           res.errorMessages
  //         );
  //       }
  //     },
  //     error: (err) => console.error('Error fetching project data:', err),
  //   });
  // } -->

<!-- end of side menu -->

<!-- Sprint view -->

<!-- <div class="col-md-6">
          <div class="card cardBottomRight h-100">
            <div class="card-body">
              <div class="header">
                <h2>Sprint Manager</h2>
              </div>
              <hr />
              @if(sprintDetails) { @for(sprint of sprintDetails ; track
              sprint.id) {
              <div class="profile gap-2">
                <img [src]="
                    sprint.createdBy.imageUrl
                      ? sprint.createdBy.imageUrl
                      : 'assets/images/scrum master profile photo.svg'
                  " alt="scrum master profile icon" />
                <div class="scrum-master-header">
                  <h3 class="mb-0">
                    {{ sprint.createdBy.firstName }}
                    {{ sprint.createdBy.lastName }}
                  </h3>
                  <p>Scrum Master</p>
                </div>
              </div>
              <div class="contact mt-2">
                <h4>Contact Info</h4>
                <div class="email gap-1 mb-2">
                  <img src="assets/images/Email.svg" alt="" />
                  <p>Email: John<span>&#64;</span>company.com</p>
                </div>
                <div class="linkedIn gap-1 mb-2">
                  <img src="assets/images/LinkedIn.svg" alt="" />
                  <p>LinkedIn: Profile</p>
                  <img src="assets/images/External Link.svg" alt="" />
                </div>
                <div class="whatsapp gap-1 mb-2">
                  <img src="assets/images/WhatsApp.svg" alt="" />
                  <p>WhatsApp: {{ sprint.createdBy.phoneNumber }}</p>
                </div>
              </div>
              } }
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card cardBottomLeft h-100 project-members">
            <div class="card-body">
              <div class="header">
                <h2>Sprint Details</h2>
              </div>
              <hr />
              @for (sprint of sprintDetails; track $index) {
              <div class="sprint-details">
                <h5>
                  <div class="sprint-data">
                    <img src="assets/images/issue view/sprint details/Sprint Iteration.svg" alt="" />
                    <span>Sprint Title</span>
                  </div>
                  <p>{{ sprint.title }}</p>
                </h5>
                <h5>
                  <div class="sprint-data">
                    <img src="assets/images/issue view/sprint details/Schedule.svg" alt="" />
                    <span>Start Date</span>
                  </div>
                  <p>{{ sprint.startDate }}</p>
                </h5>
                <h5>
                  <div class="sprint-data">
                    <img src="assets/images/issue view/sprint details/Clock Alert.svg" alt="" />
                    <span>Due Date</span>
                  </div>
                  <p>{{ sprint.endDate }}</p>
                </h5>
                <h5>
                  <div class="sprint-data">
                    <img src="assets/images/issue view/sprint details/Spinner.svg" alt="" />
                    <span>Status</span>
                  </div>
                  <p>{{ sprint.status }}</p>
                </h5>
                <h5>
                  <div class="sprint-data">
                    <img src="assets/images/issue view/sprint details/Playlist.svg" alt="" />
                    <span>Description</span>
                  </div>
                  <p>{{ sprint.description }}</p>
                </h5>
              </div>
              }
            </div>
          </div>
        </div> -->

<!--End of sprint view-->

<!-- Company view -->

<!-- // getBackendStatusFromWrapper(wrapperId: string): string {
  //   switch (wrapperId) {
  //     case 'to do': return 'to do';
  //     case 'Completed': return 'completed';
  //     case 'reviewing': return 'Reviewing';
  //     case 'canceled': return 'Canceled';
  //     case 'postponed': return 'Postponed';
  //     case 'In Progress': return 'in progress';
  //     case 'backlog': return 'Backlog';
  //     default: return 'To Do';
  //   }
  // } -->

<!-- End of company view -->
